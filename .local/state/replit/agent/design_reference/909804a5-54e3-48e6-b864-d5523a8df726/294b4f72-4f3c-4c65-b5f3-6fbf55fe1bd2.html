<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gerenciamento de Inspeções - Polícia Civil BA</title>
    
    <!-- CDN Dependencies -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.8.0/umd/Recharts.js"></script>
    <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://unpkg.com/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
    <script src="https://kit.fontawesome.com/your-kit-id.js" crossorigin="anonymous"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        'police-blue': '#1E40AF',
                        'police-light': '#3B82F6',
                        'success': '#10B981',
                        'warning': '#F59E0B',
                        'danger': '#EF4444',
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;
        const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, PieChart, Pie, Cell, LineChart, Line } = Recharts;

        // Mock data for demonstration
        const mockInspectionData = [
            {
                id: 1,
                unidade: "1ª Delegacia Regional - Salvador",
                departamento: "DRTE",
                coorpin: "COORPIN-01",
                dataInspecao: "2025-01-15",
                delegado: "João Silva Santos",
                naoConformidade: "Ausência de Livro Obrigatório",
                descricao: "Não foi localizado o livro de registro de ocorrências",
                providencias: "Determinada aquisição imediata",
                dataInicioRegularizacao: "2025-01-16",
                diasPrazo: 30,
                dataFimRegularizacao: "2025-02-15",
                statusPrazo: "Dentro do prazo"
            },
            {
                id: 2,
                unidade: "2ª Delegacia Regional - Feira de Santana",
                departamento: "DRTE",
                coorpin: "COORPIN-02",
                dataInspecao: "2025-01-10",
                delegado: "Maria Costa Lima",
                naoConformidade: "Não conformidade com Portaria 494/2023",
                descricao: "Procedimentos não estão conforme nova portaria",
                providencias: "Treinamento da equipe programado",
                dataInicioRegularizacao: "2025-01-11",
                diasPrazo: 45,
                dataFimRegularizacao: "2025-02-25",
                statusPrazo: "Dentro do prazo"
            },
            {
                id: 3,
                unidade: "3ª Delegacia Regional - Vitória da Conquista",
                departamento: "DPT",
                coorpin: "COORPIN-03",
                dataInspecao: "2024-12-20",
                delegado: "Carlos Oliveira",
                naoConformidade: "Equipamentos sem manutenção preventiva",
                descricao: "Equipamentos de informática necessitam manutenção",
                providencias: "Contrato de manutenção em andamento",
                dataInicioRegularizacao: "2024-12-21",
                diasPrazo: 60,
                dataFimRegularizacao: "2025-02-19",
                statusPrazo: "Próximo do vencimento"
            }
        ];

        // Authentication Context
        const AuthContext = createContext();

        const useAuth = () => {
            const context = useContext(AuthContext);
            if (!context) {
                throw new Error('useAuth must be used within an AuthProvider');
            }
            return context;
        };

        const AuthProvider = ({ children }) => {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [loading, setLoading] = useState(false);

            const login = async (username, password) => {
                setLoading(true);
                // TODO: Implement real API call to /api/login
                return new Promise((resolve) => {
                    setTimeout(() => {
                        if (username === 'admin' && password === 'correpol2025') {
                            setIsAuthenticated(true);
                            resolve({ success: true });
                        } else {
                            resolve({ success: false, message: 'Credenciais inválidas' });
                        }
                        setLoading(false);
                    }, 1000);
                });
            };

            const logout = () => {
                setIsAuthenticated(false);
            };

            return (
                <AuthContext.Provider value={{ isAuthenticated, login, logout, loading }}>
                    {children}
                </AuthContext.Provider>
            );
        };

        // @COMPONENT: LoginPage
        const LoginPage = () => {
            const [credentials, setCredentials] = useState({ username: '', password: '' });
            const [error, setError] = useState('');
            const { login, loading } = useAuth();

            const handleLogin = async () => {
                setError('');
                const result = await login(credentials.username, credentials.password);
                if (!result.success) {
                    setError(result.message);
                }
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-police-blue to-police-light flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
                    <div className="max-w-md w-full space-y-8">
                        <div className="text-center">
                            <!-- Civil Police badge logo -->
                            <img 
                                src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4SU
" 
                                alt="Brasão Polícia Civil BA" 
                                className="mx-auto h-20 w-auto"
                                data-mock-image="true"
                                data-implementation="Use actual Civil Police badge from provided assets"
                            />
                            <h2 className="mt-6 text-3xl font-bold text-white">
                                Sistema de Gerenciamento
                            </h2>
                            <p className="mt-2 text-sm text-blue-100">
                                Indicadores de Inspeção - ASTEC CORREPOL
                            </p>
                        </div>
                        
                        <div className="bg-white rounded-lg shadow-xl p-8 space-y-6">
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        <i className="fas fa-user mr-2"></i>
                                        Usuário
                                    </label>
                                    <input
                                        type="text"
                                        value={credentials.username}
                                        onChange={(e) => setCredentials({...credentials, username: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-police-blue focus:border-police-blue"
                                        placeholder="Digite seu usuário"
                                        data-mock="true"
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">
                                        <i className="fas fa-lock mr-2"></i>
                                        Senha
                                    </label>
                                    <input
                                        type="password"
                                        value={credentials.password}
                                        onChange={(e) => setCredentials({...credentials, password: e.target.value})}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-police-blue focus:border-police-blue"
                                        placeholder="Digite sua senha"
                                        data-mock="true"
                                    />
                                </div>
                            </div>
                            
                            {error && (
                                <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md text-sm">
                                    <i className="fas fa-exclamation-triangle mr-2"></i>
                                    {error}
                                </div>
                            )}
                            
                            <button
                                onClick={handleLogin}
                                disabled={loading}
                                className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-police-blue hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-police-blue disabled:opacity-50"
                                data-event="click:handleLogin"
                                data-implementation="Should validate credentials against backend API"
                            >
                                {loading ? (
                                    <>
                                        <i className="fas fa-spinner fa-spin mr-2"></i>
                                        Autenticando...
                                    </>
                                ) : (
                                    <>
                                        <i className="fas fa-sign-in-alt mr-2"></i>
                                        Entrar
                                    </>
                                )}
                            </button>
                            
                            <div className="text-center">
                                <p className="text-xs text-gray-500">
                                    Acesso restrito a servidores autorizados
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        // @END_COMPONENT: LoginPage

        // @COMPONENT: Header
        const Header = ({ activeTab, onTabChange, onLogout }) => {
            return (
                <header className="bg-white shadow-sm border-b border-gray-200">
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <div className="flex justify-between items-center h-16">
                            <div className="flex items-center">
                                <!-- Civil Police badge in header -->
                                <img 
                                    src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4SU=" 
                                    alt="Brasão Polícia Civil BA" 
                                    className="h-12 w-auto mr-4"
                                    data-mock-image="true"
                                    data-implementation="Use actual Civil Police badge from provided assets"
                                />
                                <div>
                                    <h1 className="text-xl font-semibold text-gray-900">
                                        Sistema de Gerenciamento de Inspeções
                                    </h1>
                                    <p className="text-sm text-gray-500">ASTEC - CORREPOL</p>
                                </div>
                            </div>
                            
                            <nav className="hidden md:flex space-x-8">
                                {[
                                    { id: 'dashboard', label: 'Dashboard Geral', icon: 'chart-bar' },
                                    { id: 'gallery', label: 'Galeria', icon: 'images' },
                                    { id: 'deadlines', label: 'Prazos', icon: 'clock' },
                                    { id: 'normalization', label: 'Normalização', icon: 'check-circle' }
                                ].map((tab) => (
                                    <button
                                        key={tab.id}
                                        onClick={() => onTabChange(tab.id)}
                                        className={`px-3 py-2 rounded-md text-sm font-medium transition-colors ${
                                            activeTab === tab.id
                                                ? 'bg-police-blue text-white'
                                                : 'text-gray-500 hover:text-gray-700 hover:bg-gray-100'
                                        }`}
                                        data-event="click:onTabChange"
                                        data-implementation="Should update active tab state"
                                    >
                                        <i className={`fas fa-${tab.icon} mr-2`}></i>
                                        {tab.label}
                                    </button>
                                ))}
                            </nav>
                            
                            <button
                                onClick={onLogout}
                                className="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"
                                data-event="click:onLogout"
                                data-implementation="Should clear authentication state and return to login"
                            >
                                <i className="fas fa-sign-out-alt mr-2"></i>
                                Sair
                            </button>
                        </div>
                    </div>
                </header>
            );
        };
        // @END_COMPONENT: Header

        // @COMPONENT: Dashboard
        const Dashboard = ({ data, filters, onFilterChange }) => {
            // Chart data processing
            const departmentData = data.reduce((acc, item) => {
                const dept = acc.find(d => d.name === item.departamento);
                if (dept) {
                    dept.value += 1;
                } else {
                    acc.push({ name: item.departamento, value: 1 });
                }
                return acc;
            }, []);

            const statusData = data.reduce((acc, item) => {
                const status = acc.find(s => s.name === item.statusPrazo);
                if (status) {
                    status.value += 1;
                } else {
                    acc.push({ name: item.statusPrazo, value: 1 });
                }
                return acc;
            }, []);

            const COLORS = ['#1E40AF', '#3B82F6', '#10B981', '#F59E0B', '#EF4444'];

            const generatePDFReport = () => {
                // TODO: Implement PDF generation with jsPDF
                // Include Civil Police badge, filtered data, charts, and statistics
                alert('Funcionalidade de geração de PDF será implementada');
            };

            return (
                <div className="space-y-6">
                    {/* Filters Section */}
                    <div className="bg-white rounded-lg shadow p-6">
                        <h3 className="text-lg font-medium text-gray-900 mb-4">
                            <i className="fas fa-filter mr-2"></i>
                            Filtros
                        </h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Unidade Inspecionada
                                </label>
                                <select 
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-police-blue focus:border-police-blue"
                                    data-mock="true"
                                >
                                    <option>Todas as unidades</option>
                                    <option>1ª Delegacia Regional - Salvador</option>
                                    <option>2ª Delegacia Regional - Feira de Santana</option>
                                </select>
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Departamento
                                </label>
                                <select 
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-police-blue focus:border-police-blue"
                                    data-mock="true"
                                >
                                    <option>Todos os departamentos</option>
                                    <option>DRTE</option>
                                    <option>DPT</option>
                                </select>
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Data Inicial
                                </label>
                                <input 
                                    type="date" 
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-police-blue focus:border-police-blue"
                                    data-mock="true"
                                />
                            </div>
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    Data Final
                                </label>
                                <input 
                                    type="date" 
                                    className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-police-blue focus:border-police-blue"
                                    data-mock="true"
                                />
                            </div>
                        </div>
                    </div>

                    {/* Statistics Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div className="bg-white rounded-lg shadow p-6">
                            <div className="flex items-center">
                                <div className="flex-shrink-0">
                                    <div className="w-8 h-8 bg-police-blue rounded-md flex items-center justify-center">
                                        <i className="fas fa-clipboard-list text-white text-sm"></i>
                                    </div>
                                </div>
                                <div className="ml-4">
                                    <p className="text-sm font-medium text-gray-500">Total de Inspeções</p>
                                    <p className="text-2xl font-semibold text-gray-900" data-bind="totalInspections">
                                        {data.length}
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow p-6">
                            <div className="flex items-center">
                                <div className="flex-shrink-0">
                                    <div className="w-8 h-8 bg-danger rounded-md flex items-center justify-center">
                                        <i className="fas fa-exclamation-triangle text-white text-sm"></i>
                                    </div>
                                </div>
                                <div className="ml-4">
                                    <p className="text-sm font-medium text-gray-500">Não Conformidades</p>
                                    <p className="text-2xl font-semibold text-gray-900" data-bind="totalNonCompliances">
                                        {data.length}
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow p-6">
                            <div className="flex items-center">
                                <div className="flex-shrink-0">
                                    <div className="w-8 h-8 bg-success rounded-md flex items-center justify-center">
                                        <i className="fas fa-check-circle text-white text-sm"></i>
                                    </div>
                                </div>
                                <div className="ml-4">
                                    <p className="text-sm font-medium text-gray-500">Dentro do Prazo</p>
                                    <p className="text-2xl font-semibold text-gray-900" data-bind="withinDeadline">
                                        {data.filter(item => item.statusPrazo === 'Dentro do prazo').length}
                                    </p>
                                </div>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow p-6">
                            <div className="flex items-center">
                                <div className="flex-shrink-0">
                                    <div className="w-8 h-8 bg-warning rounded-md flex items-center justify-center">
                                        <i className="fas fa-clock text-white text-sm"></i>
                                    </div>
                                </div>
                                <div className="ml-4">
                                    <p className="text-sm font-medium text-gray-500">Próximo do Vencimento</p>
                                    <p className="text-2xl font-semibold text-gray-900" data-bind="nearDeadline">
                                        {data.filter(item => item.statusPrazo === 'Próximo do vencimento').length}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Charts Section */}
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="bg-white rounded-lg shadow p-6">
                            <div className="flex justify-between items-center mb-4">
                                <h3 className="text-lg font-medium text-gray-900">
                                    Inspeções por Departamento
                                </h3>
                                <button
                                    onClick={generatePDFReport}
                                    className="px-4 py-2 bg-police-blue text-white text-sm rounded-md hover:bg-blue-700 transition-colors"
                                    data-event="click:generatePDFReport"
                                    data-implementation="Should generate PDF report with department statistics"
                                >
                                    <i className="fas fa-file-pdf mr-2"></i>
                                    Relatório PDF
                                </button>
                            </div>
                            <ResponsiveContainer width="100%" height={300}>
                                <BarChart data={departmentData}>
                                    <CartesianGrid strokeDasharray="3 3" />
                                    <XAxis dataKey="name" fontSize={12} />
                                    <YAxis fontSize={12} />
                                    <Tooltip />
                                    <Bar dataKey="value" fill="#1E40AF" />
                                </BarChart>
                            </ResponsiveContainer>
                        </div>

                        <div className="bg-white rounded-lg shadow p-6">
                            <h3 className="text-lg font-medium text-gray-900 mb-4">
                                Status dos Prazos
                            </h3>
                            <ResponsiveContainer width="100%" height={300}>
                                <PieChart>
                                    <Pie
                                        data={statusData}
                                        cx="50%"
                                        cy="50%"
                                        labelLine={false}
                                        label={({ name, percent }) => `${name} ${(percent * 100).toFixed(0)}%`}
                                        outerRadius={80}
                                        fill="#8884d8"
                                        dataKey="value"
                                        fontSize={12}
                                    >
                                        {statusData.map((entry, index) => (
                                            <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />
                                        ))}
                                    </Pie>
                                    <Tooltip />
                                </PieChart>
                            </ResponsiveContainer>
                        </div>
                    </div>
                </div>
            );
        };
        // @END_COMPONENT: Dashboard

        // @COMPONENT: Gallery
        const Gallery = ({ data, filters }) => {
            return (
                <div className="space-y-6">
                    <div className="bg-white rounded-lg shadow p-6">
                        <h3 className="text-lg font-medium text-gray-900 mb-6">
                            <i className="fas fa-images mr-2"></i>
                            Galeria de Inspeções
                        </h3>
                        
                        <!-- @MAP: data.map(inspection => ( -->
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {data.map((inspection, index) => (
                                <div key={inspection.id} className="bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md transition-shadow">
                                    <div className="aspect-w-16 aspect-h-9">
                                        <!-- Placeholder inspection image -->
                                        <img 
                                            src="https://images.unsplash.com/photo-1521747116042-5a810fda9664?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=400&h=250" 
                                            alt="Inspeção em unidade policial" 
                                            className="w-full h-48 object-cover rounded-t-lg"
                                            data-mock-image="true"
                                            data-implementation="Replace with actual inspection photos or use generic icons"
                                        />
                                    </div>
                                    <div className="p-4">
                                        <h4 className="text-lg font-medium text-gray-900 mb-2" data-bind="inspection.unidade">
                                            {inspection.unidade}
                                        </h4>
                                        <p className="text-sm text-gray-600 mb-2">
                                            <i className="fas fa-calendar mr-2"></i>
                                            <span data-bind="inspection.dataInspecao">{inspection.dataInspecao}</span>
                                        </p>
                                        <p className="text-sm text-gray-600 mb-3" data-bind="inspection.naoConformidade">
                                            <i className="fas fa-exclamation-circle mr-2 text-red-500"></i>
                                            {inspection.naoConformidade}
                                        </p>
                                        <div className="flex justify-between items-center">
                                            <span className={`px-2 py-1 text-xs font-medium rounded-full ${
                                                inspection.statusPrazo === 'Dentro do prazo' 
                                                    ? 'bg-green-100 text-green-800'
                                                    : inspection.statusPrazo === 'Próximo do vencimento'
                                                    ? 'bg-yellow-100 text-yellow-800'
                                                    : 'bg-red-100 text-red-800'
                                            }`} data-bind="inspection.statusPrazo">
                                                {inspection.statusPrazo}
                                            </span>
                                            <button className="text-police-blue hover:text-blue-700 text-sm font-medium">
                                                Ver Detalhes
                                                <i className="fas fa-arrow-right ml-1"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                        <!-- @END_MAP )) -->
                    </div>
                </div>
            );
        };
        // @END_COMPONENT: Gallery

        // @COMPONENT: Deadlines
        const Deadlines = ({ data }) => {
            // Calculate remaining days based on current date (22/07/2025)
            const currentDate = new Date('2025-07-22');
            
            const processedData = data.map(item => {
                const endDate = new Date(item.dataFimRegularizacao);
                const diffTime = endDate - currentDate;
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                return {
                    ...item,
                    diasRestantes: diffDays,
                    statusClass: diffDays > 7 ? 'text-green-700 bg-green-100' : 
                                diffDays > 0 ? 'text-yellow-700 bg-yellow-100' : 
                                'text-red-700 bg-red-100'
                };
            });

            return (
                <div className="space-y-6">
                    <div className="bg-white rounded-lg shadow p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="text-lg font-medium text-gray-900">
                                <i className="fas fa-clock mr-2"></i>
                                Acompanhamento de Prazos
                            </h3>
                            <button 
                                className="px-4 py-2 bg-police-blue text-white text-sm rounded-md hover:bg-blue-700 transition-colors"
                                data-event="click:generateDeadlineReport"
                                data-implementation="Should generate PDF report with deadline information"
                            >
                                <i className="fas fa-file-pdf mr-2"></i>
                                Relatório de Prazos
                            </button>
                        </div>
                        
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Unidade Inspecionada
                                        </th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Não Conformidade
                                        </th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Data Fim Regularização
                                        </th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Dias Restantes
                                        </th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                            Status
                                        </th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    <!-- @MAP: processedData.map(item => ( -->
                                    {processedData.map((item, index) => (
                                        <tr key={item.id} className="hover:bg-gray-50">
                                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900" data-bind="item.unidade">
                                                {item.unidade}
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500" data-bind="item.naoConformidade">
                                                {item.naoConformidade}
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500" data-bind="item.dataFimRegularizacao">
                                                {item.dataFimRegularizacao}
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500" data-bind="item.diasRestantes">
                                                {item.diasRestantes > 0 ? `${item.diasRestantes} dias` : `${Math.abs(item.diasRestantes)} dias em atraso`}
                                            </td>
                                            <td className="px-6 py-4 whitespace-nowrap">
                                                <span className={`px-2 py-1 text-xs font-medium rounded-full ${item.statusClass}`} data-bind="item.statusPrazo">
                                                    {item.statusPrazo}
                                                </span>
                                            </td>
                                        </tr>
                                    ))}
                                    <!-- @END_MAP )) -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        };
        // @END_COMPONENT: Deadlines

        // @COMPONENT: Normalization
        const Normalization = ({ data }) => {
            // Process non-compliance data for normalization reporting
            const nonComplianceData = data.reduce((acc, item) => {
                const compliance = acc.find(c => c.name === item.naoConformidade);
                if (compliance) {
                    compliance.value += 1;
                } else {
                    acc.push({ name: item.naoConformidade, value: 1 });
                }
                return acc;
            }, []);

            return (
                <div className="space-y-6">
                    <div className="bg-white rounded-lg shadow p-6">
                        <div className="flex justify-between items-center mb-6">
                            <h3 className="text-lg font-medium text-gray-900">
                                <i className="fas fa-check-circle mr-2"></i>
                                Relatório de Normalização
                            </h3>
                            <button 
                                className="px-4 py-2 bg-police-blue text-white text-sm rounded-md hover:bg-blue-700 transition-colors"
                                data-event="click:generateNormalizationReport"
                                data-implementation="Should generate PDF report with normalization statistics"
                            >
                                <i className="fas fa-file-pdf mr-2"></i>
                                Relatório de Conformidade
                            </button>
                        </div>
                        
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div>
                                <h4 className="text-md font-medium text-gray-900 mb-4">
                                    Frequência de Não Conformidades
                                </h4>
                                <ResponsiveContainer width="100%" height={400}>
                                    <BarChart data={nonComplianceData} layout="horizontal" margin={{ left: 150 }}>
                                        <CartesianGrid strokeDasharray="3 3" />
                                        <XAxis type="number" fontSize={12} />
                                        <YAxis type="category" dataKey="name" fontSize={12} width={150} />
                                        <Tooltip />
                                        <Bar dataKey="value" fill="#1E40AF" />
                                    </BarChart>
                                </ResponsiveContainer>
                            </div>
                            
                            <div>
                                <h4 className="text-md font-medium text-gray-900 mb-4">
                                    Tipos de Não Conformidades
                                </h4>
                                <div className="space-y-4">
                                    <!-- @MAP: nonComplianceData.map(item => ( -->
                                    {nonComplianceData.map((item, index) => (
                                        <div key={index} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                                            <div className="flex-1">
                                                <p className="text-sm font-medium text-gray-900" data-bind="item.name">
                                                    {item.name}
                                                </p>
                                                <div className="mt-2">
                                                    <div className="bg-gray-200 rounded-full h-2">
                                                        <div 
                                                            className="bg-police-blue h-2 rounded-full" 
                                                            style={{ width: `${(item.value / data.length) * 100}%` }}
                                                        ></div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="ml-4 flex-shrink-0">
                                                <span className="text-sm font-medium text-gray-900" data-bind="item.value">
                                                    {item.value}
                                                </span>
                                                <span className="text-xs text-gray-500 ml-1">
                                                    ({((item.value / data.length) * 100).toFixed(1)}%)
                                                </span>
                                            </div>
                                        </div>
                                    ))}
                                    <!-- @END_MAP )) -->
                                </div>
                                
                                <div className="mt-6 p-4 bg-blue-50 rounded-lg">
                                    <h5 className="text-sm font-medium text-gray-900 mb-2">
                                        <i className="fas fa-info-circle mr-2 text-blue-500"></i>
                                        Resumo de Conformidade
                                    </h5>
                                    <div className="text-sm text-gray-600 space-y-1">
                                        <p>• Total de inspeções realizadas: <span className="font-medium" data-bind="data.length">{data.length}</span></p>
                                        <p>• Tipos de não conformidades identificadas: <span className="font-medium" data-bind="nonComplianceData.length">{nonComplianceData.length}</span></p>
                                        <p>• Principais áreas de melhoria: Livros obrigatórios e conformidade normativa</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };
        // @END_COMPONENT: Normalization

        // @COMPONENT: MainApp
        const MainApp = () => {
            const { isAuthenticated, logout } = useAuth();
            const [activeTab, setActiveTab] = useState('dashboard');
            const [data] = useState(mockInspectionData);
            const [filters, setFilters] = useState({});

            if (!isAuthenticated) {
                return <LoginPage />;
            }

            const renderActiveTab = () => {
                switch (activeTab) {
                    case 'dashboard':
                        return <Dashboard data={data} filters={filters} onFilterChange={setFilters} />;
                    case 'gallery':
                        return <Gallery data={data} filters={filters} />;
                    case 'deadlines':
                        return <Deadlines data={data} />;
                    case 'normalization':
                        return <Normalization data={data} />;
                    default:
                        return <Dashboard data={data} filters={filters} onFilterChange={setFilters} />;
                }
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    <Header 
                        activeTab={activeTab} 
                        onTabChange={setActiveTab} 
                        onLogout={logout}
                    />
                    <main className="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
                        {renderActiveTab()}
                    </main>
                </div>
            );
        };
        // @END_COMPONENT: MainApp

        // @COMPONENT: App
        const App = () => {
            return (
                <AuthProvider>
                    <MainApp />
                </AuthProvider>
            );
        };
        // @END_COMPONENT: App

        // Render the application
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>